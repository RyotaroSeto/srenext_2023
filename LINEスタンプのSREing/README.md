# LINE スタンプの SREing 事例集：大量のスパイクアクセスを捌くための SREing

https://sre-next.dev/2023/schedule/#jp037

- 過負荷時、マイクロサービスのうちどれに影響が高いか。(あけおめライン)

## サーバー増設開始までの 30 日間

### アクセス増加見込みのあるマイクロサービスの確認

- 各サービスのマイクロサービスの担当に今年何かあった確認

### 各マイクロサービスの処理性能の確認

- 1 サーバー何リクエスト捌けるか確認
- カオスエンジニアリングの考え方を踏襲、高負荷試験実施
  - 仮説、検証を行う

### ピークのアクセス数を計算する

- アクセスの変化率を見る
- 平常時の前年比のアクセス数をみる
- 前年のアクセス数を見る
- 3 つの見積もり結果から悲観的な値を採用する

### サーバー増設台数を計算

- 安全マージンを出す
  - 予測のアクセス見積もりの 2 倍を設定するなど

### 関連サービスからのフォールバックアクセスを確認する

- フォールバックの時のメトリクスは取れていないため、地道にどのくらい取れているか確認

### Priritized Load Shedding 準備のためのワークショップ開催

- 高負荷に陥った場合、ユーザー影響の小さい機能を停止して、重要な機能だけでも死守するようにする
- どの API を Load Shedding しても良いか事前に決定しておく

### ワークショップ中に発見されたエラーハンドリングの改善

- 動作の中でエラーハンド r ングで改善できる部分があれば改善

### 処理性能の改善時に発見されたボトルネックの改善

- JsonWebToken の verfication で CPU 使用率が非常に高いなぢ

### 監視用ダッシュボードの準備

### 誰がどのマイクロサービスを監視するか人員配置する

### マーケティングチームに当日の push 通知時刻の確認

### あけおめライン当日
